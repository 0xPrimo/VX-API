#pragma once
#include "MalwareHeader.h"

#define InitializeObjectAttributes(p, n, a, r, s) \
{ \
	(p)->Length = sizeof(OBJECT_ATTRIBUTES); \
	(p)->RootDirectory = r; \
	(p)->Attributes = a; \
	(p)->ObjectName = n; \
	(p)->SecurityDescriptor = s; \
	(p)->SecurityQualityOfService = NULL; \
}

LPVOID RtlHeapAllocForward(SIZE_T Size)
{
	return (Size != 0 ? pfnRtlAllocateHeap(GetProcessHeapAlt(), HEAP_ZERO_MEMORY, Size) : NULL);
}

BOOL RtlHeapFreeForward(LPVOID lpMem)
{
	return (lpMem == NULL ? FALSE : pfnFreeHeap(GetProcessHeapAlt(), HEAP_ZERO_MEMORY, lpMem));
}

BOOL RtlCloseHandleForward(HANDLE hObject)
{
	return pfnNtClose(hObject);
}